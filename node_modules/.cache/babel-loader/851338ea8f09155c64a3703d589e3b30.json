{"ast":null,"code":"import * as PIXI from \"pixi.js\";\nimport blueGradient from \"../assets/blue-gradient.png\";\nimport * as CONST from \"./const.js\";\nimport QuestionMark from '../assets/QuestionMark.png';\nexport const init = (app, setup) => {\n  // console.log(\"setup\",setup)\n  const windowWidth = setup.width;\n  const windowHeight = setup.height;\n  const wallWidth = setup.width * 0.9;\n  const wallX = (windowWidth - wallWidth) / 2;\n  const height = setup.height / 15;\n  let dx = setup.height / 15;\n  let dy = dx;\n  let dragged = false;\n  let dragStartedAt;\n  let backGround = new PIXI.Sprite.from(blueGradient);\n  backGround.width = setup.width;\n  backGround.height = setup.height;\n  backGround.x = 0;\n  backGround.y = 0;\n\n  if (true) {\n    app.stage.addChild(backGround);\n  }\n\n  window.createjs.Tween.get(backGround).to({\n    alpha: 1\n  }, 500, window.createjs.Ease.getPowInOut(4)); // Hacky what the hell is this doing here?\n\n  app.stage.y = -height / 2; // console.log(\"app\", app);\n  // Denominator of the row that's currently place on the number line.\n\n  let activeRow = 12; // Numerator of Active Row (this is the fraction that will be shaded)\n\n  let activeNum = 0; // Is the program currently swapping rows?\n\n  let swapping = false;\n  const labels = {\n    1: \"One Whole\",\n    2: \"One Half\",\n    3: \"One Third\",\n    4: \"Fourth\",\n    5: \"5th\",\n    6: \"6th\",\n    7: \"7th\",\n    8: \"8th\",\n    9: \"9th\",\n    10: \"10th\",\n    11: \"11th\",\n    12: \"12th\"\n  }; // Constructors\n\n  function distance(a, b) {\n    let x1 = a[0];\n    let y1 = a[1];\n    let x2 = b[0];\n    let y2 = b[1];\n    let dX = x2 - x1;\n    let dY = y2 - y1;\n    return Math.sqrt(Math.pow(dX, 2) + Math.pow(dY, 2));\n  }\n\n  const wallObj = {\n    1: [],\n    2: [],\n    3: [],\n    4: [],\n    5: [],\n    6: [],\n    7: [],\n    8: [],\n    9: [],\n    10: [],\n    11: [],\n    12: []\n  };\n\n  for (var i = 1; i <= 12; i++) {\n    let w = wallWidth / i;\n    let c = new PIXI.Container();\n    c.denValue = i;\n    c.on('pointerdown', onContainerDragStart);\n    c.on('pointerup', onContainerDragEnd);\n    c.on('pointermove', onContainerDragMove);\n\n    for (var j = 0; j < i; j++) {\n      let h = height;\n      let x = windowWidth / 2 - wallWidth / 2 + j * w + w / 2;\n      let y = h + i * h;\n      let tile = createTile(x, y, w, h, i);\n      c.addChild(tile);\n      app.stage.addChild(tile);\n    }\n\n    wallObj[i] = c;\n  }\n\n  function newTexture(self, color) {\n    var graphics = new PIXI.Graphics();\n    graphics.lineStyle(3, 0x000000, 1);\n\n    if (color) {\n      graphics.beginFill(color);\n    }\n\n    graphics.drawRoundedRect(0, 0, self.width - 3, self.height - 3, 3);\n    graphics.endFill();\n    return app.renderer.generateTexture(graphics);\n  }\n\n  function swapCompleted() {\n    swapping = false;\n  }\n\n  function moveRowUp(row) {\n    row.forEach(t => {\n      t.dragging = false;\n      window.createjs.Tween.get(t).to({\n        y: t.y - height\n      }, 300, window.createjs.Ease.getPowInOut(4));\n    });\n  }\n\n  function moveRowDown(row) {\n    row.forEach(t => {\n      t.dragging = false;\n      window.createjs.Tween.get(t).to({\n        y: t.y + height\n      }, 300, window.createjs.Ease.getPowInOut(4));\n    });\n  }\n\n  let tickArray = [];\n\n  function initTickArray(d) {\n    for (var i = 0; i <= 12; i++) {\n      let tick = new PIXI.Graphics();\n      tick.lineStyle(4, 0xb7b7b7, 1);\n      tick.moveTo(wallX, 12.5 * height);\n      tick.lineTo(wallX, 13.5 * height);\n      app.stage.addChild(tick);\n      tickArray.push(tick);\n      window.createjs.Tween.get(tick).to({\n        x: wallWidth / d * i\n      }, 1000, window.createjs.Ease.getPowInOut(4));\n    }\n  }\n\n  function drawNumberLine(den) {\n    let line = new PIXI.Graphics();\n    line.lineStyle(4, 0xb7b7b7, 1);\n    line.moveTo(wallX, 13 * height);\n    line.lineTo(wallX + wallWidth, 13 * height);\n    app.stage.addChild(line);\n  }\n\n  function animateTicks(den) {\n    tickArray.forEach((t, i) => {\n      if (i > den) {\n        window.createjs.Tween.get(t).to({\n          x: wallWidth\n        }, 1000, window.createjs.Ease.getPowInOut(4));\n      } else {\n        window.createjs.Tween.get(t).to({\n          x: wallWidth / den * i\n        }, 1000, window.createjs.Ease.getPowInOut(4));\n      }\n    });\n  }\n\n  function swapRow(row, start, end) {\n    if (Math.abs(start - end) < 30) {\n      row.forEach(t => window.createjs.Tween.get(t).to({\n        y: start\n      }, 300, window.createjs.Ease.getPowInOut(4)).call(swapCompleted));\n    } // Moved up\n    else if (start > end) {\n        for (var r in wallObj) {\n          if (wallObj[r].y < start && wallObj[r].y > end) {\n            moveRowDown(wallObj[r]);\n          }\n        }\n\n        let roundedEnd = Math.ceil(end / height) * height;\n        row.forEach(t => window.createjs.Tween.get(t).to({\n          y: roundedEnd\n        }, 300, window.createjs.Ease.getPowInOut(4)).call(swapCompleted));\n      } // Moved down\n      else if (start < end) {\n          for (var r in wallObj) {\n            if (wallObj[r].y > start && wallObj[r].y < end) {\n              moveRowUp(wallObj[r]);\n            }\n          }\n\n          let roundedEnd = Math.floor(end / height) * height;\n          row.forEach(t => window.createjs.Tween.get(t).to({\n            y: roundedEnd\n          }, 300, window.createjs.Ease.getPowInOut(4)).call(swapCompleted));\n        }\n  }\n\n  function createReset() {}\n\n  function createTile(x, y, w, h, d) {\n    var graphics = new PIXI.Graphics();\n    graphics.lineStyle(3, 0x000000, 1);\n    graphics.drawRoundedRect(0, 0, w, h, 3);\n    graphics.endFill();\n    var texture = app.renderer.generateTexture(graphics);\n    let tile = new PIXI.Sprite(texture);\n    tile.anchor.set(0.5);\n    let den = new PIXI.Text(labels[d], {\n      fontFamily: \"Arial\",\n      fontSize: h / 2,\n      fill: \"0xffffff\",\n      align: \"center\"\n    });\n    den.alpha = 0;\n    den.anchor.set(0.5);\n    tile.on(\"pointerdown\", onDragStart);\n    tile.addChild(tile);\n    tile.addChild(den);\n    tile.active = false;\n    tile.interactive = true;\n    tile.denText = den;\n    tile.denValue = d;\n    tile.buttonMode = true;\n    tile.on(\"pointerdown\", onDragStart).on(\"pointerup\", onDragEnd).on(\"pointermove\", onDragMove); // move the sprite to its designated position\n\n    tile.x = x;\n    tile.y = y;\n    return tile;\n  }\n\n  function onContainerDragStart(event) {\n    if (!swapping) {\n      // console.log(\"setting dragging to true\");\n      this.dragging = true;\n      dragStartedAt = this.y;\n      this.data = event.data;\n      this.alpha = 0.5;\n    }\n  }\n\n  function onContainerDragEnd() {\n    if (dragged) {\n      dragged = false;\n      let row = wallObj[this.denValue];\n      activeRow = this.den;\n      swapRow(row, dragStartedAt, this.y);\n\n      if (this.y > 12 * height) {\n        animateTicks(activeRow);\n      }\n    } else {\n      this.active = !this.active;\n      this.denText.alpha = this.active ? 1 : 0;\n      this.texture = this.active ? newTexture(this, 0xff708a) : newTexture(this);\n    }\n\n    this.alpha = 1;\n    this.dragging = false;\n    this.data = null;\n  }\n\n  function onContainerDragMove() {\n    console.log(\"dragging\", this.dragging);\n\n    if (this.dragging) {\n      dragged = true;\n      var newPosition = this.data.getLocalPosition(this.parent);\n      wallObj[this.denValue].y = newPosition;\n    }\n  }\n\n  function onDragStart(event) {\n    if (!swapping) {\n      // console.log(\"setting dragging to true\");\n      this.dragging = true;\n      dragStartedAt = this.y;\n      this.data = event.data;\n      this.alpha = 0.5;\n    }\n  }\n\n  function onDragEnd() {\n    if (dragged) {\n      dragged = false;\n      let row = wallObj[this.denValue];\n      activeRow = this.den;\n      swapRow(row, dragStartedAt, this.y);\n\n      if (this.y > 12 * height) {\n        animateTicks(activeRow);\n      }\n    } else {\n      this.active = !this.active;\n      this.denText.alpha = this.active ? 1 : 0;\n      this.texture = this.active ? newTexture(this, 0xff708a) : newTexture(this);\n    }\n\n    this.alpha = 1;\n    this.dragging = false;\n    this.data = null;\n  }\n\n  function onDragMove() {\n    console.log(\"dragging\", this.dragging);\n\n    if (this.dragging) {\n      dragged = true;\n      var newPosition = this.data.getLocalPosition(this.parent);\n      wallObj[this.denValue].y = newPosition;\n    }\n  }\n\n  let questionButton = new PIXI.Sprite.from(QuestionMark);\n  questionButton.x = setup.width - 1.5 * dx;\n  questionButton.y = dx / 4;\n  questionButton.width = dx;\n  questionButton.height = dx;\n  questionButton.interactive = true;\n  questionButton.on('pointerdown', () => {\n    app.help();\n  }); //app.stage.addChild(questionButton)\n};","map":{"version":3,"sources":["/Users/andrewfenner/Documents/MindResearch/Prototypes/newtestunit/src/js/fractionwall.js"],"names":["PIXI","blueGradient","CONST","QuestionMark","init","app","setup","windowWidth","width","windowHeight","height","wallWidth","wallX","dx","dy","dragged","dragStartedAt","backGround","Sprite","from","x","y","stage","addChild","window","createjs","Tween","get","to","alpha","Ease","getPowInOut","activeRow","activeNum","swapping","labels","distance","a","b","x1","y1","x2","y2","dX","dY","Math","sqrt","pow","wallObj","i","w","c","Container","denValue","on","onContainerDragStart","onContainerDragEnd","onContainerDragMove","j","h","tile","createTile","newTexture","self","color","graphics","Graphics","lineStyle","beginFill","drawRoundedRect","endFill","renderer","generateTexture","swapCompleted","moveRowUp","row","forEach","t","dragging","moveRowDown","tickArray","initTickArray","d","tick","moveTo","lineTo","push","drawNumberLine","den","line","animateTicks","swapRow","start","end","abs","call","r","roundedEnd","ceil","floor","createReset","texture","anchor","set","Text","fontFamily","fontSize","fill","align","onDragStart","active","interactive","denText","buttonMode","onDragEnd","onDragMove","event","data","console","log","newPosition","getLocalPosition","parent","questionButton","help"],"mappings":"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","sourcesContent":["import * as PIXI from \"pixi.js\";\nimport blueGradient from \"../assets/blue-gradient.png\";\nimport * as CONST from \"./const.js\";\nimport QuestionMark from '../assets/QuestionMark.png'\n\nexport const init = (app, setup) => {\n  // console.log(\"setup\",setup)\n  const windowWidth = setup.width;\n  const windowHeight = setup.height;\n  const wallWidth = setup.width*0.9;\n  const wallX = (windowWidth - wallWidth) / 2;\n  const height = setup.height / 15;\n  let dx = setup.height / 15;\n  let dy = dx;\n  let dragged = false\n  let dragStartedAt;\n\n  let backGround = new PIXI.Sprite.from(blueGradient);\n\n  backGround.width = setup.width\n  backGround.height = setup.height\n  backGround.x = 0;\n  backGround.y = 0;\n\n  if (true) {\n    app.stage.addChild(backGround);\n  }\n  window.createjs.Tween.get(backGround).to(\n    { alpha: 1 },\n    500,\n    window.createjs.Ease.getPowInOut(4)\n  );\n\n\n\n  // Hacky what the hell is this doing here?\n  app.stage.y = -height / 2;\n\n  // console.log(\"app\", app);\n\n  // Denominator of the row that's currently place on the number line.\n  let activeRow = 12;\n\n  // Numerator of Active Row (this is the fraction that will be shaded)\n  let activeNum = 0;\n\n  // Is the program currently swapping rows?\n  let swapping = false;\n\n  const labels = {\n    1: \"One Whole\",\n    2: \"One Half\",\n    3: \"One Third\",\n    4: \"Fourth\",\n    5: \"5th\",\n    6: \"6th\",\n    7: \"7th\",\n    8: \"8th\",\n    9: \"9th\",\n    10: \"10th\",\n    11: \"11th\",\n    12: \"12th\"\n  };\n\n  // Constructors\n\n  function distance(a, b) {\n    let x1 = a[0];\n    let y1 = a[1];\n    let x2 = b[0];\n    let y2 = b[1];\n    let dX = x2 - x1;\n    let dY = y2 - y1;\n    return Math.sqrt(Math.pow(dX, 2) + Math.pow(dY, 2));\n  }\n\n  const wallObj = {\n    1: [],\n    2: [],\n    3: [],\n    4: [],\n    5: [],\n    6: [],\n    7: [],\n    8: [],\n    9: [],\n    10: [],\n    11: [],\n    12: []\n  };\n\n\n \n  for (var i = 1; i <= 12; i++) {\n    let w = wallWidth / i;\n    let c = new PIXI.Container()\n    c.denValue = i\n    c.on('pointerdown',onContainerDragStart)\n    c.on('pointerup',onContainerDragEnd)\n    c.on('pointermove',onContainerDragMove)\n    for (var j = 0; j < i; j++) {\n      let h = height;\n      let x = windowWidth/2 - wallWidth/2 + j * w + w / 2;\n      let y = h+i * h;\n      let tile = createTile(x, y, w, h, i);\n      c.addChild(tile);\n      app.stage.addChild(tile);\n    }\n    wallObj[i] = c\n\n  }\n\n  function newTexture(self, color) {\n    var graphics = new PIXI.Graphics();\n    graphics.lineStyle(3, 0x000000, 1);\n    if (color) {graphics.beginFill(color)}\n    graphics.drawRoundedRect(0, 0, self.width - 3, self.height - 3, 3);\n    graphics.endFill();\n    return app.renderer.generateTexture(graphics);\n  }\n\n  function swapCompleted() {\n    swapping = false;\n  }\n\n  function moveRowUp(row) {\n    row.forEach(t => {\n      t.dragging = false\n      window.createjs.Tween.get(t).to(\n        { y: t.y - height },\n        300,\n        window.createjs.Ease.getPowInOut(4)\n      )\n    });\n  }\n\n  function moveRowDown(row) {\n    row.forEach(t =>{\n      t.dragging = false\n      window.createjs.Tween.get(t).to(\n        { y: t.y + height },\n        300,\n        window.createjs.Ease.getPowInOut(4)\n      )\n    });\n  }\n\n  let tickArray = [];\n\n  function initTickArray(d) {\n    for (var i = 0; i <= 12; i++) {\n      let tick = new PIXI.Graphics();\n      tick.lineStyle(4, 0xb7b7b7, 1);\n      tick.moveTo(wallX, 12.5 * height);\n      tick.lineTo(wallX, 13.5 * height);\n      app.stage.addChild(tick);\n      tickArray.push(tick);\n      window.createjs.Tween.get(tick).to(\n        { x: (wallWidth / d) * i },\n        1000,\n        window.createjs.Ease.getPowInOut(4)\n      );\n    }\n  }\n\n  function drawNumberLine(den) {\n    let line = new PIXI.Graphics();\n    line.lineStyle(4, 0xb7b7b7, 1);\n    line.moveTo(wallX, 13 * height);\n    line.lineTo(wallX + wallWidth, 13 * height);\n    app.stage.addChild(line);\n  }\n\n  function animateTicks(den) {\n    tickArray.forEach((t, i) => {\n      if (i > den) {\n        window.createjs.Tween.get(t).to(\n          { x: wallWidth },\n          1000,\n          window.createjs.Ease.getPowInOut(4)\n        );\n      } else {\n        window.createjs.Tween.get(t).to(\n          { x: (wallWidth / den) * i },\n          1000,\n          window.createjs.Ease.getPowInOut(4)\n        );\n      }\n    });\n  }\n\n  function swapRow(row, start, end) {\n    if (Math.abs(start - end) < 30) {\n      row.forEach(t =>\n        window.createjs.Tween.get(t)\n          .to({ y: start }, 300, window.createjs.Ease.getPowInOut(4))\n          .call(swapCompleted)\n      );\n    }\n    // Moved up\n    else if (start > end) {\n      for (var r in wallObj) {\n        if (wallObj[r].y < start && wallObj[r].y > end) {\n          moveRowDown(wallObj[r]);\n        }\n      }\n      let roundedEnd = Math.ceil(end / height) * height;\n      row.forEach(t =>\n        window.createjs.Tween.get(t)\n          .to({ y: roundedEnd }, 300, window.createjs.Ease.getPowInOut(4))\n          .call(swapCompleted)\n      );\n    }\n    // Moved down\n    else if (start < end) {\n      for (var r in wallObj) {\n        if (wallObj[r].y > start && wallObj[r].y < end) {\n          moveRowUp(wallObj[r]);\n        }\n      }\n      let roundedEnd = Math.floor(end / height) * height;\n      row.forEach(t =>\n        window.createjs.Tween.get(t)\n          .to({ y: roundedEnd }, 300, window.createjs.Ease.getPowInOut(4))\n          .call(swapCompleted)\n      );\n    }\n  }\n\n  function createReset(){\n\n  }\n\n  function createTile(x, y, w, h, d) {\n    var graphics = new PIXI.Graphics();\n    graphics.lineStyle(3, 0x000000, 1);\n    graphics.drawRoundedRect(0, 0, w, h, 3);\n    graphics.endFill();\n\n    var texture = app.renderer.generateTexture(graphics);\n    let tile = new PIXI.Sprite(texture);\n    tile.anchor.set(0.5);\n\n    let den = new PIXI.Text(labels[d], {\n      fontFamily: \"Arial\",\n      fontSize: h / 2,\n      fill: \"0xffffff\",\n      align: \"center\"\n    });\n    den.alpha = 0\n    den.anchor.set(0.5);\n\n\n    tile.on(\"pointerdown\", onDragStart);\n\n    tile.addChild(tile);\n    tile.addChild(den);\n\n    tile.active = false;\n    tile.interactive = true;\n    tile.denText = den;\n    tile.denValue = d\n    tile.buttonMode = true;\n  \n    tile\n      .on(\"pointerdown\", onDragStart)\n      .on(\"pointerup\", onDragEnd)\n      .on(\"pointermove\", onDragMove);\n\n    // move the sprite to its designated position\n    tile.x = x;\n    tile.y = y;\n\n    return tile;\n  }\n\n\n  function onContainerDragStart(event) {\n    if (!swapping) {\n      // console.log(\"setting dragging to true\");\n      this.dragging = true;\n      dragStartedAt = this.y;\n      this.data = event.data;\n      this.alpha = 0.5;\n    }\n  }\n\n  function onContainerDragEnd() {\n    if (dragged) {\n      dragged = false;\n      let row = wallObj[this.denValue];\n      activeRow = this.den;\n      swapRow(row, dragStartedAt, this.y);\n      if (this.y > 12 * height) {\n        animateTicks(activeRow);\n      }\n    } else {\n     \n      this.active = !this.active;\n      this.denText.alpha = this.active ? 1 : 0\n      this.texture = this.active\n        ? newTexture(this, 0xff708a)\n        : newTexture(this);\n      \n    }\n    this.alpha = 1;\n    this.dragging = false;\n    this.data = null;\n  }\n\n  function onContainerDragMove() {\n    console.log(\"dragging\",this.dragging)\n    if (this.dragging) {\n      dragged = true;\n      var newPosition = this.data.getLocalPosition(this.parent);\n      wallObj[this.denValue].y = newPosition\n    }\n  }\n\n\n  function onDragStart(event) {\n    if (!swapping) {\n      // console.log(\"setting dragging to true\");\n      this.dragging = true;\n      dragStartedAt = this.y;\n      this.data = event.data;\n      this.alpha = 0.5;\n    }\n  }\n\n  function onDragEnd() {\n    if (dragged) {\n      dragged = false;\n      let row = wallObj[this.denValue];\n      activeRow = this.den;\n      swapRow(row, dragStartedAt, this.y);\n      if (this.y > 12 * height) {\n        animateTicks(activeRow);\n      }\n    } else {\n     \n      this.active = !this.active;\n      this.denText.alpha = this.active ? 1 : 0\n      this.texture = this.active\n        ? newTexture(this, 0xff708a)\n        : newTexture(this);\n      \n    }\n    this.alpha = 1;\n    this.dragging = false;\n    this.data = null;\n  }\n\n  function onDragMove() {\n    console.log(\"dragging\",this.dragging)\n    if (this.dragging) {\n      dragged = true;\n      var newPosition = this.data.getLocalPosition(this.parent);\n      wallObj[this.denValue].y = newPosition\n    }\n  }\n\n\n  let questionButton = new PIXI.Sprite.from(QuestionMark)\n    questionButton.x = setup.width - 1.5*dx\n    questionButton.y = dx/4\n    questionButton.width = dx\n    questionButton.height = dx\n    questionButton.interactive = true\n    questionButton.on('pointerdown',()=> {app.help()})\n    //app.stage.addChild(questionButton)\n\n};\n"]},"metadata":{},"sourceType":"module"}