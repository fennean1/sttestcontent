{"ast":null,"code":"import * as PIXI from \"pixi.js\";\nimport * as CONST from \"./const.js\";\nimport { TweenMax, TimelineLite, Power2, Elastic, CSSPlugin, TweenLite, TimelineMax } from \"gsap/TweenMax\";\nimport { SSL_OP_TLS_BLOCK_PADDING_BUG, SSL_OP_SSLEAY_080_CLIENT_DH_BUG } from \"constants\";\nimport { number } from \"prop-types\";\nimport { tsExpressionWithTypeArguments, thisExpression, throwStatement } from \"@babel/types\";\nconst ASSETS = CONST.ASSETS;\nexport const init = (app, setup) => {\n  // Constants\n  const BLUE_TEXTURE = new PIXI.Texture.from(CONST.ASSETS.BLUE_CIRCLE);\n  const LINE_PERCENTAGE = 0.8;\n  const PIN_TEXTURE = new PIXI.Texture.from(ASSETS.SHARP_PIN); // Initial State\n\n  let state = {\n    valA: 8,\n    valB: 8,\n    lineMax: 20\n  };\n  console.log(\"setupwidth\", setup.width);\n  console.log(\"windowheight\", window.innerHeight); // Layout Parameters\n\n  let WINDOW_WIDTH = setup.width;\n  let BAR_HEIGHT = setup.height / 8;\n  let WINDOW_HEIGHT = setup.height;\n  let H_W_RATIO = setup.height / setup.width;\n  let LANDSCAPE = H_W_RATIO < 3 / 4;\n  let ARENA_WIDTH = LANDSCAPE ? 4 / 3 * setup.height : setup.width;\n  let ARENA_HEIGHT = LANDSCAPE ? setup.height : 3 / 4 * setup.width;\n  let LINE_WIDTH = LINE_PERCENTAGE * WINDOW_WIDTH;\n  let LINE_THICKNESS = LINE_WIDTH / 200;\n  let TICK_THICKNESS = 2 * LINE_THICKNESS / 3;\n  let MAJOR_TICK_HEIGHT = LINE_WIDTH / 20;\n  let MINOR_TICK_HEIGHT = MAJOR_TICK_HEIGHT / 2;\n  let DX = LINE_WIDTH / state.lineMax;\n  let LINE_START = WINDOW_WIDTH / 2 - LINE_WIDTH / 2;\n  let STRIP_HEIGHT = LINE_WIDTH / 12;\n  let TOP_LINE_Y = WINDOW_HEIGHT / 4;\n  let BOTTOM_LINE_Y = WINDOW_HEIGHT * 3 / 4; // RELEVENT\n\n  let ActiveRow;\n  let ActiveIndex = 0;\n  let FirstRow;\n  let SecondRow;\n  let ThirdRow;\n  let FourthRow;\n  var Rows;\n\n  function placeButtons() {\n    let x = Rows[ActiveIndex].container.x;\n    let y = Rows[ActiveIndex].container.y;\n    let w = Rows[ActiveIndex].container.width;\n    let h = Rows[ActiveIndex].container.height;\n    PlusButton.x = x + w;\n    PlusButton.y = y;\n    MinusButton.x = x - BAR_HEIGHT;\n    MinusButton.y = y;\n  }\n\n  let PlusButton = new PIXI.Sprite.from(ASSETS.PLUS);\n  PlusButton.interactive = true; //PlusButton.anchor.set(0.5)\n\n  PlusButton.on('pointerdown', () => {\n    PlusButton.interactive = false;\n    incActiveFrac(1);\n    setTimeout(() => {\n      PlusButton.interactive = true;\n    }, 300);\n  });\n  PlusButton.width = BAR_HEIGHT;\n  PlusButton.height = BAR_HEIGHT;\n  PlusButton.y = 3 / 4 * WINDOW_HEIGHT;\n  PlusButton.x = 3 / 4 * WINDOW_WIDTH;\n  let MinusButton = new PIXI.Sprite.from(ASSETS.MINUS);\n  MinusButton.interactive = true; //MinusButton.anchor.set(0.5)\n\n  MinusButton.on('pointerdown', () => {\n    MinusButton.interactive = false;\n    incActiveFrac(-1);\n    setTimeout(() => {\n      MinusButton.interactive = true;\n    }, 300);\n  });\n  MinusButton.width = BAR_HEIGHT;\n  MinusButton.height = BAR_HEIGHT;\n  MinusButton.y = 3 / 4 * WINDOW_HEIGHT;\n  MinusButton.x = 1 / 4 * WINDOW_WIDTH;\n  let LeftWhisker = new PIXI.Graphics();\n  let RightWhisker = new PIXI.Graphics();\n  let A;\n  let B; // Reference to entities. - deprecated.\n\n  let backGround;\n  let numberLine;\n  let topNumberLine;\n  let pinA;\n  let pinB;\n  let stripA;\n  let stripB;\n  let stripBLabel;\n  let stripALabel;\n  let incButton;\n  let decButton;\n  let activePin;\n\n  function incActiveFrac(inc) {\n    Rows[ActiveIndex].incDenonimator(inc);\n  } // Constructors (should not be called on re-draw)\n\n\n  function makeNumberLine(flip) {\n    this.tickSpan = 1;\n    this.labelSpan = 1;\n    this.max = state.lineMax;\n    this.ticks = []; // size 120\n\n    this.labels = [];\n    this.line = new PIXI.Graphics();\n\n    this.init = n => {\n      this.line.lineStyle(LINE_THICKNESS, 0x000000);\n      this.line.x = ARENA_WIDTH / 2 - LINE_WIDTH / 2;\n      this.line.y = ARENA_HEIGHT / 2;\n      this.line.lineTo(LINE_WIDTH, 0);\n      this.draw();\n      app.stage.addChild(this.line);\n\n      for (let i = 0; i < 120; i++) {\n        let newTick = new PIXI.Graphics();\n        newTick.lineStyle(LINE_THICKNESS, 0x000000);\n        newTick.x = this.line.x;\n\n        if (flip) {\n          newTick.y = this.line.y + LINE_THICKNESS / 2;\n          newTick.lineTo(0, -MINOR_TICK_HEIGHT);\n        } else {\n          newTick.y = this.line.y - LINE_THICKNESS / 2;\n          newTick.lineTo(0, MINOR_TICK_HEIGHT);\n        }\n\n        app.stage.addChild(newTick);\n        this.ticks.push(newTick); // Setup Labels Here\n\n        let newLabel = new PIXI.Text(i, {\n          fontFamily: \"Arial\",\n          fontSize: DX / 2,\n          fill: \"0x000000\",\n          align: \"center\"\n        });\n        newLabel.anchor.x = 0.5;\n        this.labels.push(newLabel);\n        newLabel.x = this.line.x + DX * i;\n        newLabel.y = this.line.y + MINOR_TICK_HEIGHT;\n\n        if (flip) {\n          newLabel.y = this.line.y - 2 * MINOR_TICK_HEIGHT;\n        }\n\n        app.stage.addChild(newLabel);\n      }\n\n      this.increment(0);\n    };\n\n    this.getSetup = () => {// update tickspan etc. based on line max.\n    };\n\n    this.increment = inc => {\n      // Animation go here\n      this.max += inc; // Update State - (Context Specific)\n\n      state.lineMax = this.max;\n      updateLayoutParams();\n      this.ticks.forEach((e, i) => {\n        if (i > this.max) {\n          TweenLite.to(e, 0.5, {\n            x: LINE_WIDTH + this.line.x\n          });\n        } else {\n          TweenLite.to(e, 0.5, {\n            x: LINE_WIDTH / this.max * i + this.line.x\n          });\n        }\n      });\n      this.labels.forEach((e, i) => {\n        if (i > this.max) {\n          TweenLite.to(e, 0.5, {\n            x: LINE_WIDTH + this.line.x\n          });\n          TweenLite.to(e, 0.5, {\n            alpha: 0\n          });\n        } else {\n          TweenLite.to(e, 0.5, {\n            x: LINE_WIDTH / this.max * i + this.line.x\n          });\n          TweenLite.to(e, 0.5, {\n            alpha: 1\n          });\n        }\n      });\n    };\n\n    this.draw = () => {\n      let _y;\n\n      if (flip) {\n        _y = TOP_LINE_Y;\n      } else {\n        _y = BOTTOM_LINE_Y;\n      }\n\n      this.line.width = LINE_WIDTH;\n      this.line.height = LINE_THICKNESS;\n      this.line.x = WINDOW_WIDTH / 2 - LINE_WIDTH / 2;\n      this.line.y = _y;\n      this.ticks.forEach((e, i) => {\n        e.width = TICK_THICKNESS;\n        e.height = MINOR_TICK_HEIGHT;\n        e.y = this.line.y - LINE_THICKNESS / 2;\n\n        if (i > this.max) {\n          e.x = LINE_WIDTH + this.line.x;\n        } else {\n          e.x = LINE_WIDTH / this.max * i + this.line.x;\n        }\n      });\n      this.labels.forEach((e, i) => {\n        e.y = this.line.y + MINOR_TICK_HEIGHT;\n        e.style.fontSize = DX / 2;\n\n        if (i > this.max) {\n          e.x = LINE_WIDTH + this.line.x;\n        } else {\n          e.x = LINE_WIDTH / this.max * i + this.line.x;\n        }\n      });\n    };\n\n    this.init();\n  }\n\n  function makeBackground() {\n    // Setup Background\n    this.sprite = new PIXI.Sprite.from(CONST.ASSETS.BLUE_GRADIENT);\n    this.sprite.width = WINDOW_WIDTH;\n    this.sprite.height = WINDOW_HEIGHT;\n    this.sprite.x = 0;\n    this.sprite.y = 0;\n    this.sprite.on('pointerup', globalPointerUp);\n    this.sprite.interactive = true;\n    app.stage.addChild(this.sprite);\n\n    this.draw = () => {\n      this.sprite.width = WINDOW_WIDTH;\n      this.sprite.height = WINDOW_HEIGHT;\n    };\n  }\n\n  function makePin(id) {\n    this.sprite = new PIXI.Sprite();\n    this.sprite.id = id;\n    this.sprite.texture = PIN_TEXTURE;\n    this.sprite.interactive = true;\n    this.sprite.anchor.x = 0.5;\n    this.sprite.on('pointerdown', onDragStart);\n    this.sprite.on('pointermove', onDragMove);\n    this.sprite.on('pointerup', onDragEnd);\n    this.sprite.x = WINDOW_WIDTH / 2 - LINE_WIDTH / 2;\n    this.sprite.val = 8;\n    app.stage.addChild(this.sprite);\n\n    this.sprite.round = () => {\n      // Pre Computation\n      let rawLineX = this.sprite.x - numberLine.line.x;\n      let n = Math.round(rawLineX / DX); // Setting\n\n      this.sprite.x = numberLine.line.x + n * DX;\n      this.sprite.val = n;\n      drawWhiskers(); // There's gotta be a better pattern than this\n\n      if (this.sprite.id == 0) {\n        state.valA = this.sprite.val;\n      } else if (this.sprite.id == 1) {\n        state.valB = this.sprite.val;\n      }\n    };\n\n    this.draw = () => {\n      this.sprite.width = STRIP_HEIGHT;\n      this.sprite.height = STRIP_HEIGHT;\n      this.sprite.y = BOTTOM_LINE_Y + MINOR_TICK_HEIGHT + DX / 2;\n      this.sprite.x = WINDOW_WIDTH / 2 - LINE_WIDTH / 2 + this.sprite.val * DX;\n    };\n\n    this.draw();\n  } // Pin Drag Functions\n\n\n  function onDragStart(event) {\n    app.stage.addChild(this);\n    this.deltaTouch = {\n      x: this.x - event.data.global.x,\n      y: this.y - event.data.global.y\n    };\n    this.dragging = true;\n    this.data = event.data;\n  }\n\n  function onDragEnd(event) {\n    this.dragging = false;\n    this.data = null;\n    this.round();\n    Rows[ActiveIndex].draw(this.x - LINE_START);\n    drawWhiskers();\n    placeButtons();\n  }\n\n  function onDragMove(event) {\n    if (this.dragging) {\n      let width = this.x - LINE_START;\n      Rows[ActiveIndex].draw(width);\n      drawWhiskers();\n      placeButtons();\n      let newPosition = this.data.getLocalPosition(this.parent);\n      this.x = newPosition.x + this.deltaTouch.x; // Keep within number line bounds.\n\n      if (this.x < WINDOW_WIDTH / 2 - LINE_WIDTH / 2) {\n        this.dragging = false;\n        this.x = WINDOW_WIDTH / 2 - LINE_WIDTH / 2;\n      } else if (this.x > WINDOW_WIDTH / 2 + LINE_WIDTH / 2) {\n        this.dragging = false;\n        this.x = WINDOW_WIDTH / 2 + LINE_WIDTH / 2;\n      }\n    }\n  }\n\n  function makeArrowButton(inc) {\n    let button = new PIXI.Sprite.from(CONST.ASSETS.ARROW);\n    button.inc = inc;\n    button.interactive = true;\n    button.anchor.set(0.5);\n    button.on('pointerdown', () => {\n      numberLine.increment(inc);\n      topNumberLine.increment(inc);\n      resize(null, false);\n    });\n    app.stage.addChild(button);\n\n    button.draw = () => {\n      if (button.inc == -5) {\n        button.width = STRIP_HEIGHT / 2;\n        button.height = STRIP_HEIGHT / 2;\n        button.x = WINDOW_WIDTH - 1.1 * button.width;\n        button.y = WINDOW_HEIGHT / 2 + 1 / 2 * button.width;\n        button.rotation = Math.PI;\n      } else if (button.inc == 5) {\n        button.width = STRIP_HEIGHT / 2;\n        button.height = STRIP_HEIGHT / 2;\n        button.x = WINDOW_WIDTH - 1.1 * button.width;\n        button.y = WINDOW_HEIGHT / 2 - 1 / 2 * button.width;\n      }\n    };\n\n    return button;\n  }\n\n  app.stage.on('pointerdown', resizeLine);\n  app.stage.interactive = true;\n\n  function resizeLine(event) {}\n\n  function Row(num, den, width, ID) {\n    // Internal Params\n    let touching = true; // Default values\n\n    this.numerator = num;\n    this.denominator = den;\n    this.width = width;\n    this.id = ID;\n    this.container = new PIXI.Container();\n    this.container.id = ID;\n    this.container.width = width;\n    this.container.interactive = true;\n    this.container.y = BOTTOM_LINE_Y - BAR_HEIGHT;\n    this.container.x = LINE_START;\n    this.sprites = [];\n    this.blockWidth = width / this.denominator;\n    this.blockA = new PIXI.Graphics();\n    this.blockA.lineStyle(3, 0x000000);\n    this.blockA.drawRoundedRect(0, 0, this.blockWidth, BAR_HEIGHT, 1);\n    let myA = app.renderer.generateTexture(this.blockA);\n    this.blockB = new PIXI.Graphics();\n    this.blockB.beginFill(0xff4772);\n    this.blockB.lineStyle(3, 0x000000);\n    this.blockB.drawRoundedRect(0, 0, this.blockWidth, BAR_HEIGHT, 1);\n    let myB = app.renderer.generateTexture(this.blockB);\n    let g = new PIXI.Graphics();\n\n    this.incDenonimator = inc => {\n      g.clear();\n      g.lineStyle(3, 0x000000);\n      g.drawRoundedRect(0, 0, this.width, BAR_HEIGHT, 1);\n      let R = app.renderer.generateTexture(g);\n      let s = new PIXI.Sprite();\n      this.container.addChild(s);\n      s.texture = R;\n      s.x = 0;\n\n      if (inc > 0) {\n        const onComplete = () => {\n          s.on('pointerdown', spritePointerDown);\n          s.on('pointerup', spritePointerUp);\n          s.on('pointermove', spritePointerMoved);\n          s.interactive = true;\n          s.active = false;\n          this.sprites.push(s);\n          this.draw();\n        };\n\n        TweenMax.to(this, 0.25, {\n          denominator: this.denominator + 1,\n          onUpdate: this.draw,\n          onComplete: onComplete\n        });\n      } else if (inc < 0) {\n        let removeme = this.sprites.pop();\n        this.container.removeChild(removeme);\n\n        const onComplete = () => {\n          this.draw();\n          this.container.removeChild(s);\n        };\n\n        TweenMax.to(this, 0.25, {\n          denominator: this.denominator - 1,\n          onUpdate: this.draw,\n          onComplete: onComplete\n        });\n      }\n    };\n\n    this.draw = width => {\n      if (width) {\n        this.width = width;\n      }\n\n      this.blockWidth = this.width / this.denominator;\n      this.blockA.clear();\n      this.blockA.lineStyle(3, 0x000000);\n      this.blockA.drawRoundedRect(0, 0, this.blockWidth, BAR_HEIGHT, 1);\n      myA = app.renderer.generateTexture(this.blockA);\n      this.blockB.clear();\n      this.blockB.beginFill(0xff4772);\n      this.blockB.lineStyle(3, 0x000000);\n      this.blockB.drawRoundedRect(0, 0, this.blockWidth, BAR_HEIGHT, 1);\n      myB = app.renderer.generateTexture(this.blockB);\n\n      for (let i = 0; i < this.sprites.length; i++) {\n        if (this.sprites[i].active) {\n          this.sprites[i].texture = myB;\n        } else {\n          this.sprites[i].texture = myA;\n        }\n\n        this.sprites[i].x = this.blockWidth * i;\n        this.sprites[i].y = 0;\n      }\n    };\n\n    for (let i = 0; i < this.denominator; i++) {\n      console.log(\"balls\");\n      let s = new PIXI.Sprite.from(myA);\n      s.on('pointerdown', spritePointerDown);\n      s.on('pointerup', spritePointerUp);\n      s.on('pointermove', spritePointerMoved);\n      s.interactive = true;\n      s.active = false;\n      s.x = i * LINE_WIDTH / this.denominator;\n      s.y = WINDOW_HEIGHT / 2 - BAR_HEIGHT;\n      this.sprites.push(s);\n      this.container.addChild(s);\n    } //  Attached methods\n\n\n    this.container.on('pointerdown', containerPointerDown);\n    this.container.on('pointerup', containerPointerUp);\n    this.container.on('pointermove', containerPointerMove); // Add children\n\n    app.stage.addChild(this.container);\n    this.width = this.container.width;\n\n    function spritePointerDown(event) {\n      this.touched = true;\n      this.dragged = false;\n    }\n\n    function spritePointerMoved(event) {\n      if (this.touched) {\n        console.log(\"pointermove\");\n        this.dragged = true;\n      }\n    }\n\n    function spritePointerUp(event) {\n      this.touched = false;\n      console.log('this.draggeed', this.dragged);\n\n      if (!this.dragged) {\n        this.dragged = false;\n        this.active = !this.active;\n        this.alpha = 0.2;\n        this.texture = this.active ? myB : myA;\n        TweenLite.to(this, 0.4, {\n          alpha: 1\n        });\n      }\n    }\n\n    function containerPointerDown(event) {\n      ActiveIndex = this.id;\n      drawWhiskers();\n      placeButtons();\n      pinA.sprite.x = this.width + LINE_START;\n      this.data = event.data;\n      this.startWidth = this.width;\n      this.dragStartY = event.data.global.y;\n      this.touching = true;\n      touching = true;\n      this.deltaTouch = {\n        x: this.x - event.data.global.x,\n        y: this.y - event.data.global.y\n      };\n    }\n\n    function containerPointerUp(event) {\n      this.touching = false;\n      touching = false;\n    }\n\n    function containerPointerMove(event) {\n      if (this.touching) {\n        const newPosition = this.data.getLocalPosition(this.parent);\n        this.y = event.data.global.y + this.deltaTouch.y; //this.x = event.data.global.x + this.deltaTouch.x\n        //pinA.sprite.x = this.x + this.width\n\n        this.dragged = true;\n        drawWhiskers();\n        placeButtons();\n      }\n    }\n\n    this.draw(width);\n  }\n\n  function drawWhiskers() {\n    console.log(\"Active index\", ActiveIndex);\n    console.log(\"row\", Rows);\n    LeftWhisker.clear();\n    LeftWhisker.lineStyle(2, 0x000000);\n    LeftWhisker.moveTo(Rows[ActiveIndex].container.x, Rows[ActiveIndex].container.y);\n    LeftWhisker.lineTo(Rows[ActiveIndex].container.x, numberLine.line.y);\n    RightWhisker.clear();\n    LeftWhisker.lineStyle(2, 0x000000);\n    LeftWhisker.moveTo(Rows[ActiveIndex].container.x + Rows[ActiveIndex].width, Rows[ActiveIndex].container.y);\n    LeftWhisker.lineTo(Rows[ActiveIndex].container.x + Rows[ActiveIndex].width, numberLine.line.y);\n  }\n\n  function globalPointerUp() {\n    // Ughhh...\n    Rows[ActiveIndex].container.touching = false;\n    pinA.sprite.dragging = false;\n    pinA.sprite.round();\n    Rows[ActiveIndex].draw(pinA.sprite.x - LINE_START);\n    drawWhiskers(); //pinB.sprite.round()\n    //stripA.draw()\n    //stripB.draw()\n    //stripALabel.draw()\n    //stripBLabel.draw()\n  } // Called on resize\n\n\n  function resize(newFrame, flex) {\n    // Make sure all layout parameters are up to date.\n    updateLayoutParams(newFrame);\n    app.renderer.resize(WINDOW_WIDTH, WINDOW_HEIGHT);\n    numberLine.draw();\n    topNumberLine.draw();\n    backGround.draw();\n    pinA.draw();\n    incButton.draw();\n    decButton.draw();\n    Rows.forEach(r => r.draw());\n    drawWhiskers();\n  }\n\n  function updateLayoutParams(newFrame) {\n    let frame;\n\n    if (newFrame) {\n      frame = newFrame;\n    } else {\n      frame = {\n        width: WINDOW_WIDTH,\n        height: WINDOW_HEIGHT\n      };\n    }\n\n    WINDOW_WIDTH = frame.width;\n    WINDOW_HEIGHT = frame.height;\n    H_W_RATIO = frame.height / frame.width;\n    LANDSCAPE = H_W_RATIO < 3 / 4;\n    ARENA_WIDTH = LANDSCAPE ? 4 / 3 * frame.height : frame.width;\n    ARENA_HEIGHT = LANDSCAPE ? frame.height : 3 / 4 * frame.width;\n    LINE_WIDTH = LINE_PERCENTAGE * WINDOW_WIDTH;\n    LINE_THICKNESS = LINE_WIDTH / 200;\n    TICK_THICKNESS = LINE_THICKNESS / 2;\n    MAJOR_TICK_HEIGHT = LINE_WIDTH / 20;\n    MINOR_TICK_HEIGHT = MAJOR_TICK_HEIGHT / 2;\n    DX = LINE_WIDTH / state.lineMax;\n    LINE_START = WINDOW_WIDTH / 2 - LINE_WIDTH / 2;\n    STRIP_HEIGHT = LINE_WIDTH / 12;\n  } // Loading Script\n\n\n  function load() {\n    let features = {\n      'strips': true\n    };\n\n    if (setup.props.features) {\n      features = setup.props.features;\n    }\n\n    backGround = new makeBackground(); // Number Lines\n\n    numberLine = new makeNumberLine();\n    topNumberLine = new makeNumberLine(true);\n    pinA = new makePin(0);\n    pinA.sprite.y = BOTTOM_LINE_Y + 2 * MINOR_TICK_HEIGHT; //pinB = new makePin(1)\n\n    incButton = makeArrowButton(5);\n    decButton = makeArrowButton(-5);\n    incButton.draw();\n    decButton.draw();\n    FirstRow = new Row(3, 4, pinA.sprite.x - LINE_START, 0);\n    SecondRow = new Row(1, 3, pinA.sprite.x - LINE_START, 1);\n    SecondRow.container.y = TOP_LINE_Y;\n    Rows = [FirstRow, SecondRow];\n    app.stage.addChild(LeftWhisker);\n    app.stage.addChild(RightWhisker);\n    app.stage.addChild(PlusButton);\n    app.stage.addChild(MinusButton);\n    drawWhiskers();\n    placeButtons();\n  } // Call load script\n\n\n  load(); // Not sure where else to put this.\n\n  app.resize = frame => resize(frame);\n\n  app.resizable = true;\n};","map":{"version":3,"sources":["/Users/andrewfenner/Documents/MindResearch/Prototypes/newtestunit/src/js/fractionstacks.js"],"names":["PIXI","CONST","TweenMax","TimelineLite","Power2","Elastic","CSSPlugin","TweenLite","TimelineMax","SSL_OP_TLS_BLOCK_PADDING_BUG","SSL_OP_SSLEAY_080_CLIENT_DH_BUG","number","tsExpressionWithTypeArguments","thisExpression","throwStatement","ASSETS","init","app","setup","BLUE_TEXTURE","Texture","from","BLUE_CIRCLE","LINE_PERCENTAGE","PIN_TEXTURE","SHARP_PIN","state","valA","valB","lineMax","console","log","width","window","innerHeight","WINDOW_WIDTH","BAR_HEIGHT","height","WINDOW_HEIGHT","H_W_RATIO","LANDSCAPE","ARENA_WIDTH","ARENA_HEIGHT","LINE_WIDTH","LINE_THICKNESS","TICK_THICKNESS","MAJOR_TICK_HEIGHT","MINOR_TICK_HEIGHT","DX","LINE_START","STRIP_HEIGHT","TOP_LINE_Y","BOTTOM_LINE_Y","ActiveRow","ActiveIndex","FirstRow","SecondRow","ThirdRow","FourthRow","Rows","placeButtons","x","container","y","w","h","PlusButton","MinusButton","Sprite","PLUS","interactive","on","incActiveFrac","setTimeout","MINUS","LeftWhisker","Graphics","RightWhisker","A","B","backGround","numberLine","topNumberLine","pinA","pinB","stripA","stripB","stripBLabel","stripALabel","incButton","decButton","activePin","inc","incDenonimator","makeNumberLine","flip","tickSpan","labelSpan","max","ticks","labels","line","n","lineStyle","lineTo","draw","stage","addChild","i","newTick","push","newLabel","Text","fontFamily","fontSize","fill","align","anchor","increment","getSetup","updateLayoutParams","forEach","e","to","alpha","_y","style","makeBackground","sprite","BLUE_GRADIENT","globalPointerUp","makePin","id","texture","onDragStart","onDragMove","onDragEnd","val","round","rawLineX","Math","drawWhiskers","event","deltaTouch","data","global","dragging","newPosition","getLocalPosition","parent","makeArrowButton","button","ARROW","set","resize","rotation","PI","resizeLine","Row","num","den","ID","touching","numerator","denominator","Container","sprites","blockWidth","blockA","drawRoundedRect","myA","renderer","generateTexture","blockB","beginFill","myB","g","clear","R","s","onComplete","spritePointerDown","spritePointerUp","spritePointerMoved","active","onUpdate","removeme","pop","removeChild","length","containerPointerDown","containerPointerUp","containerPointerMove","touched","dragged","startWidth","dragStartY","moveTo","newFrame","flex","r","frame","load","features","props","resizable"],"mappings":"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","sourcesContent":["import * as PIXI from \"pixi.js\";\nimport * as CONST from \"./const.js\";\nimport { TweenMax, TimelineLite, Power2, Elastic, CSSPlugin, TweenLite, TimelineMax } from \"gsap/TweenMax\";\nimport { SSL_OP_TLS_BLOCK_PADDING_BUG, SSL_OP_SSLEAY_080_CLIENT_DH_BUG } from \"constants\";\nimport { number } from \"prop-types\";\nimport { tsExpressionWithTypeArguments, thisExpression, throwStatement } from \"@babel/types\";\nconst ASSETS = CONST.ASSETS\n\nexport const init = (app, setup) => {\n\n  // Constants\n  const BLUE_TEXTURE = new PIXI.Texture.from(CONST.ASSETS.BLUE_CIRCLE)\n  const LINE_PERCENTAGE = 0.8\n  const PIN_TEXTURE = new PIXI.Texture.from(ASSETS.SHARP_PIN)\n\n // Initial State\n  let state = {\n    valA: 8,\n    valB: 8,\n    lineMax: 20,\n  }\n\n  console.log(\"setupwidth\",setup.width)\n  console.log(\"windowheight\",window.innerHeight)\n\n  // Layout Parameters\n  let WINDOW_WIDTH = setup.width\n  let BAR_HEIGHT = setup.height/8\n  let WINDOW_HEIGHT = setup.height\n  let H_W_RATIO = setup.height/setup.width\n  let LANDSCAPE = H_W_RATIO < 3/4\n  let ARENA_WIDTH = LANDSCAPE ? 4/3*setup.height : setup.width\n  let ARENA_HEIGHT = LANDSCAPE ? setup.height : 3/4*setup.width\n  let LINE_WIDTH = LINE_PERCENTAGE*WINDOW_WIDTH\n  let LINE_THICKNESS = LINE_WIDTH/200\n  let TICK_THICKNESS = 2*LINE_THICKNESS/3\n  let MAJOR_TICK_HEIGHT = LINE_WIDTH/20\n  let MINOR_TICK_HEIGHT = MAJOR_TICK_HEIGHT/2\n  let DX = LINE_WIDTH/state.lineMax\n  let LINE_START = WINDOW_WIDTH/2 - LINE_WIDTH/2\n  let STRIP_HEIGHT = LINE_WIDTH/12\n  let TOP_LINE_Y = WINDOW_HEIGHT/4\n  let BOTTOM_LINE_Y = WINDOW_HEIGHT*3/4\n\n\n  // RELEVENT\n  let ActiveRow;\n  let ActiveIndex = 0\n  let FirstRow\n  let SecondRow\n  let ThirdRow;\n  let FourthRow;\n  var Rows;\n\n  function placeButtons(){\n    let x = Rows[ActiveIndex].container.x\n    let y = Rows[ActiveIndex].container.y\n    let w = Rows[ActiveIndex].container.width\n    let h = Rows[ActiveIndex].container.height\n    PlusButton.x = x + w \n    PlusButton.y = y \n    MinusButton.x = x - BAR_HEIGHT\n    MinusButton.y = y\n  }\n\n  let PlusButton = new PIXI.Sprite.from(ASSETS.PLUS)\n  PlusButton.interactive = true\n  //PlusButton.anchor.set(0.5)\n  PlusButton.on('pointerdown',()=>{\n    PlusButton.interactive = false\n    incActiveFrac(1)\n    setTimeout(()=>{PlusButton.interactive = true},300)\n  })\n  PlusButton.width = BAR_HEIGHT\n  PlusButton.height = BAR_HEIGHT\n  PlusButton.y = 3/4*WINDOW_HEIGHT\n  PlusButton.x = 3/4*WINDOW_WIDTH\n  let MinusButton = new PIXI.Sprite.from(ASSETS.MINUS)\n  MinusButton.interactive = true\n  //MinusButton.anchor.set(0.5)\n  MinusButton.on('pointerdown',()=>{\n    MinusButton.interactive = false\n    incActiveFrac(-1)\n    setTimeout(()=>{MinusButton.interactive = true},300)\n  })\n  MinusButton.width = BAR_HEIGHT\n  MinusButton.height = BAR_HEIGHT\n  MinusButton.y = 3/4*WINDOW_HEIGHT\n  MinusButton.x = 1/4*WINDOW_WIDTH\n\n  let LeftWhisker  = new PIXI.Graphics()\n  let RightWhisker = new PIXI.Graphics()\n\n  let A;\n  let B;\n\n  // Reference to entities. - deprecated.\n  let backGround;\n  let numberLine;\n  let topNumberLine;\n  let pinA;\n  let pinB;\n  let stripA;\n  let stripB;\n  let stripBLabel;\n  let stripALabel;\n  let incButton;\n  let decButton;\n  let activePin;\n\n\n  function incActiveFrac(inc){\n    Rows[ActiveIndex].incDenonimator(inc)\n  }\n\n \n  // Constructors (should not be called on re-draw)\n  function makeNumberLine(flip){\n     this.tickSpan = 1\n     this.labelSpan = 1\n     this.max = state.lineMax\n     this.ticks = [] // size 120\n     this.labels = []\n     this.line = new PIXI.Graphics()\n\n     this.init = (n) => {\n        this.line.lineStyle(LINE_THICKNESS,0x000000)\n        this.line.x = ARENA_WIDTH/2-LINE_WIDTH/2\n        this.line.y = ARENA_HEIGHT/2\n        this.line.lineTo(LINE_WIDTH,0)\n        this.draw()\n        app.stage.addChild(this.line)\n\n        for (let i = 0;i<120;i++){\n            let newTick = new PIXI.Graphics()\n            newTick.lineStyle(LINE_THICKNESS,0x000000)\n            newTick.x = this.line.x \n            if(flip){\n              newTick.y = this.line.y + LINE_THICKNESS/2\n              newTick.lineTo(0,-MINOR_TICK_HEIGHT)\n            } else {\n              newTick.y = this.line.y - LINE_THICKNESS/2\n              newTick.lineTo(0,MINOR_TICK_HEIGHT)\n            }\n            app.stage.addChild(newTick)\n            this.ticks.push(newTick)\n\n            // Setup Labels Here\n            let newLabel = new PIXI.Text(i,{\n              fontFamily: \"Arial\",\n              fontSize: DX/2,\n              fill: \"0x000000\",\n              align: \"center\"\n            })\n            newLabel.anchor.x = 0.5\n            this.labels.push(newLabel)\n            newLabel.x = this.line.x + DX*i\n            newLabel.y = this.line.y + MINOR_TICK_HEIGHT\n            if (flip){\n              newLabel.y = this.line.y - 2*MINOR_TICK_HEIGHT\n            }\n            app.stage.addChild(newLabel)\n        }\n        this.increment(0)\n     }\n\n     this.getSetup = ()=> {\n         // update tickspan etc. based on line max.\n     }\n\n     this.increment = (inc) => {\n         // Animation go here\n         this.max += inc\n\n         // Update State - (Context Specific)\n         state.lineMax = this.max\n         updateLayoutParams()\n\n         this.ticks.forEach((e,i)=> {\n            if (i > this.max){\n                TweenLite.to(e,0.5,{x: LINE_WIDTH + this.line.x })\n            } else {\n                TweenLite.to(e,0.5,{x: LINE_WIDTH/this.max*i + this.line.x})\n            }\n         })\n\n         this.labels.forEach((e,i)=> {\n          if (i > this.max){\n              TweenLite.to(e,0.5,{x: LINE_WIDTH + this.line.x })\n              TweenLite.to(e,0.5,{alpha: 0})\n          } else {\n              TweenLite.to(e,0.5,{x: LINE_WIDTH/this.max*i + this.line.x})\n              TweenLite.to(e,0.5,{alpha: 1})\n          }\n       })\n     }\n\n     this.draw = () => {\n       let _y;\n       if (flip){\n        _y = TOP_LINE_Y\n       } else {\n         _y = BOTTOM_LINE_Y\n       }\n        this.line.width = LINE_WIDTH\n        this.line.height = LINE_THICKNESS\n        this.line.x = WINDOW_WIDTH/2 - LINE_WIDTH/2\n        this.line.y = _y\n        this.ticks.forEach((e,i)=> {\n            e.width = TICK_THICKNESS\n            e.height = MINOR_TICK_HEIGHT\n            e.y = this.line.y - LINE_THICKNESS/2\n            if (i > this.max){\n                e.x = LINE_WIDTH + this.line.x \n            } else {\n                e.x =  LINE_WIDTH/this.max*i + this.line.x\n            }\n         })\n         this.labels.forEach((e,i)=> {\n          e.y = this.line.y + MINOR_TICK_HEIGHT\n          e.style.fontSize = DX/2\n          if (i > this.max){\n              e.x = LINE_WIDTH + this.line.x \n          } else {\n              e.x =  LINE_WIDTH/this.max*i + this.line.x\n          }\n       })\n     }\n     this.init()\n  }\n\n\n\n  function makeBackground(){\n    // Setup Background\n    this.sprite = new PIXI.Sprite.from(CONST.ASSETS.BLUE_GRADIENT);\n    this.sprite.width = WINDOW_WIDTH\n    this.sprite.height = WINDOW_HEIGHT\n    this.sprite.x = 0;\n    this.sprite.y = 0;\n    this.sprite.on('pointerup',globalPointerUp)\n    this.sprite.interactive = true\n\n    app.stage.addChild(this.sprite)\n\n    this.draw = () => {\n        this.sprite.width = WINDOW_WIDTH\n        this.sprite.height = WINDOW_HEIGHT\n    }\n  }\n\n\n  function makePin(id){\n    this.sprite = new PIXI.Sprite()\n    this.sprite.id = id\n    this.sprite.texture = PIN_TEXTURE\n    this.sprite.interactive = true\n    this.sprite.anchor.x = 0.5\n    this.sprite.on('pointerdown',onDragStart)\n    this.sprite.on('pointermove',onDragMove)\n    this.sprite.on('pointerup',onDragEnd)\n    this.sprite.x = WINDOW_WIDTH/2 - LINE_WIDTH/2\n    this.sprite.val = 8\n    app.stage.addChild(this.sprite)\n\n    this.sprite.round = () => {\n\n      // Pre Computation\n      let rawLineX = this.sprite.x - numberLine.line.x\n      let n = Math.round(rawLineX/DX)\n\n      // Setting\n      this.sprite.x = numberLine.line.x + n*DX\n      this.sprite.val = n\n\n      drawWhiskers()\n      // There's gotta be a better pattern than this\n      if (this.sprite.id == 0){\n        state.valA = this.sprite.val\n      } else if (this.sprite.id == 1){\n        state.valB = this.sprite.val\n      }\n    }\n\n    this.draw = () => { \n      this.sprite.width = STRIP_HEIGHT\n      this.sprite.height = STRIP_HEIGHT\n      this.sprite.y = BOTTOM_LINE_Y + MINOR_TICK_HEIGHT + DX/2\n      this.sprite.x = WINDOW_WIDTH/2 - LINE_WIDTH/2 + this.sprite.val*DX\n    }\n    this.draw()\n   }\n\n  // Pin Drag Functions\n  function onDragStart(event) {\n      app.stage.addChild(this)\n      this.deltaTouch = {\n        x: this.x - event.data.global.x,\n        y: this.y - event.data.global.y\n      }\n      this.dragging = true;\n      this.data = event.data;\n  }\n\n  function onDragEnd(event) {\n    this.dragging = false;\n    this.data = null;\n    this.round()\n    Rows[ActiveIndex].draw(this.x - LINE_START)\n    drawWhiskers()\n    placeButtons()\n  }\n\n  function onDragMove(event) {\n    if (this.dragging) {\n      let width = this.x - LINE_START\n      Rows[ActiveIndex].draw(width)\n      drawWhiskers()\n      placeButtons()\n      let newPosition = this.data.getLocalPosition(this.parent);\n      this.x = newPosition.x + this.deltaTouch.x;\n\n      // Keep within number line bounds.\n      if (this.x < WINDOW_WIDTH/2-LINE_WIDTH/2){\n        this.dragging = false\n        this.x = WINDOW_WIDTH/2-LINE_WIDTH/2\n      } else if (this.x > WINDOW_WIDTH/2+LINE_WIDTH/2) {\n        this.dragging = false\n        this.x = WINDOW_WIDTH/2+LINE_WIDTH/2\n      }\n    }\n  }\n\n  function makeArrowButton(inc){\n    let button = new PIXI.Sprite.from(CONST.ASSETS.ARROW)\n    button.inc = inc\n    button.interactive = true\n    button.anchor.set(0.5)\n    button.on('pointerdown',()=>{\n      numberLine.increment(inc)\n      topNumberLine.increment(inc)\n      resize(null,false)\n    })\n    app.stage.addChild(button)\n\n    button.draw = () => {\n      if (button.inc == -5){\n        button.width = STRIP_HEIGHT/2\n        button.height = STRIP_HEIGHT/2\n        button.x = WINDOW_WIDTH - 1.1*button.width\n        button.y = WINDOW_HEIGHT/2 + 1/2*button.width\n        button.rotation = Math.PI\n      } else if (button.inc == 5){\n        button.width = STRIP_HEIGHT/2\n        button.height = STRIP_HEIGHT/2\n        button.x = WINDOW_WIDTH - 1.1*button.width\n        button.y = WINDOW_HEIGHT/2  - 1/2*button.width\n      }\n    }\n    return button\n  }\n\n  app.stage.on('pointerdown',resizeLine)\n  app.stage.interactive = true\n\n  function resizeLine(event){\n \n  }\n\n\n\n\n \n  function Row(num,den,width,ID){\n\n    // Internal Params\n    let touching = true   \n    \n    // Default values\n    this.numerator = num\n    this.denominator = den\n    this.width = width\n    this.id = ID\n  \n    this.container = new PIXI.Container()\n    this.container.id = ID\n    this.container.width = width\n    this.container.interactive = true\n    this.container.y = BOTTOM_LINE_Y - BAR_HEIGHT\n    this.container.x = LINE_START \n    this.sprites = []\n  \n\n    this.blockWidth = width / this.denominator\n\n    this.blockA = new PIXI.Graphics()\n    this.blockA.lineStyle(3,0x000000) \n    this.blockA.drawRoundedRect(0,0,this.blockWidth,BAR_HEIGHT,1)\n    let myA = app.renderer.generateTexture(this.blockA)\n\n    this.blockB = new PIXI.Graphics()\n    this.blockB.beginFill(0xff4772)\n    this.blockB.lineStyle(3,0x000000) \n    this.blockB.drawRoundedRect(0,0,this.blockWidth,BAR_HEIGHT,1)\n    let myB = app.renderer.generateTexture(this.blockB)\n\n    let g = new PIXI.Graphics()    \n \n  \n\n    this.incDenonimator = (inc) => {\n      g.clear()\n      g.lineStyle(3,0x000000) \n      g.drawRoundedRect(0,0,this.width,BAR_HEIGHT,1)\n      let R = app.renderer.generateTexture(g)\n      let s = new PIXI.Sprite()\n      this.container.addChild(s)\n      s.texture = R\n      s.x  = 0\n\n      if (inc > 0){\n        const onComplete = ()=>{\n          s.on('pointerdown',spritePointerDown)\n          s.on('pointerup',spritePointerUp)\n          s.on('pointermove',spritePointerMoved)\n          s.interactive = true\n          s.active = false\n          this.sprites.push(s)\n          this.draw()\n        }\n        TweenMax.to(this, 0.25, {denominator: this.denominator+1,onUpdate: this.draw,onComplete: onComplete})\n      } else if (inc < 0) {\n        let removeme  = this.sprites.pop()\n        this.container.removeChild(removeme)\n        const onComplete = ()=>{\n          this.draw()\n          this.container.removeChild(s)\n        }\n        TweenMax.to(this, 0.25, {denominator: this.denominator-1,onUpdate: this.draw,onComplete: onComplete})\n      }\n    }\n\n    this.draw = (width) => {\n\n      if (width) {\n        this.width = width\n      }\n      this.blockWidth = this.width/this.denominator\n\n      this.blockA.clear()\n      this.blockA.lineStyle(3,0x000000) \n      this.blockA.drawRoundedRect(0,0,this.blockWidth,BAR_HEIGHT,1)\n      myA = app.renderer.generateTexture(this.blockA)\n\n      this.blockB.clear()\n      this.blockB.beginFill(0xff4772)\n      this.blockB.lineStyle(3,0x000000) \n      this.blockB.drawRoundedRect(0,0,this.blockWidth,BAR_HEIGHT,1)\n      myB = app.renderer.generateTexture(this.blockB)\n\n      for (let i = 0;i<this.sprites.length;i++){\n        if (this.sprites[i].active){\n          this.sprites[i].texture = myB\n        } else {\n          this.sprites[i].texture = myA\n        }\n\n        this.sprites[i].x = this.blockWidth*i\n        this.sprites[i].y = 0\n      }\n    }\n\n    for (let i = 0;i<this.denominator;i++) {\n      console.log(\"balls\")\n      let s = new PIXI.Sprite.from(myA)\n      s.on('pointerdown',spritePointerDown)\n      s.on('pointerup',spritePointerUp)\n      s.on('pointermove',spritePointerMoved)\n      s.interactive = true\n      s.active = false\n      s.x = i*LINE_WIDTH/this.denominator\n      s.y = WINDOW_HEIGHT/2 - BAR_HEIGHT\n      this.sprites.push(s)\n      this.container.addChild(s)\n    }\n      \n\n    //  Attached methods\n    this.container.on('pointerdown',containerPointerDown)\n    this.container.on('pointerup',containerPointerUp)\n    this.container.on('pointermove',containerPointerMove)\n\n    // Add children\n    app.stage.addChild(this.container)\n    this.width = this.container.width\n  \n\n    function spritePointerDown(event){\n      this.touched = true\n      this.dragged = false\n    }\n\n    function spritePointerMoved(event) {\n\n      if (this.touched){\n        console.log(\"pointermove\")\n        this.dragged = true\n      }\n    }\n\n    function spritePointerUp(event){\n         this.touched = false\n         console.log('this.draggeed',this.dragged)\n     if (!this.dragged) {\n        this.dragged = false\n        this.active = !this.active\n        this.alpha = 0.2\n        this.texture = this.active ? myB : myA\n        TweenLite.to(this,0.4,{alpha: 1})\n       }\n    }\n\n \n   function containerPointerDown(event) {\n      ActiveIndex = this.id\n      drawWhiskers()\n      placeButtons()\n      pinA.sprite.x = this.width + LINE_START\n      this.data = event.data\n      this.startWidth = this.width\n      this.dragStartY = event.data.global.y\n      this.touching = true\n      touching = true\n      this.deltaTouch = {\n        x: this.x - event.data.global.x,\n        y: this.y - event.data.global.y\n      }\n    }\n\n \n   function containerPointerUp(event) {\n      this.touching = false\n      touching = false\n    }\n\n    function containerPointerMove(event) {\n      if (this.touching){\n        const newPosition = this.data.getLocalPosition(this.parent);\n        this.y = event.data.global.y + this.deltaTouch.y\n        //this.x = event.data.global.x + this.deltaTouch.x\n        //pinA.sprite.x = this.x + this.width\n        this.dragged = true\n        drawWhiskers()\n        placeButtons()\n      }\n    }\n\n\n    this.draw(width)\n\n  }\n\n  function drawWhiskers(){\n    console.log(\"Active index\",ActiveIndex)\n    console.log(\"row\",Rows)\n\n    LeftWhisker.clear()\n    LeftWhisker.lineStyle(2,0x000000)\n    LeftWhisker.moveTo(Rows[ActiveIndex].container.x,Rows[ActiveIndex].container.y)\n    LeftWhisker.lineTo(Rows[ActiveIndex].container.x,numberLine.line.y)\n\n    RightWhisker.clear()\n    LeftWhisker.lineStyle(2,0x000000)\n    LeftWhisker.moveTo(Rows[ActiveIndex].container.x+Rows[ActiveIndex].width,Rows[ActiveIndex].container.y)\n    LeftWhisker.lineTo(Rows[ActiveIndex].container.x+Rows[ActiveIndex].width,numberLine.line.y)\n  }\n\n  function globalPointerUp(){\n    // Ughhh...\n    Rows[ActiveIndex].container.touching = false\n    pinA.sprite.dragging = false\n    pinA.sprite.round()\n    Rows[ActiveIndex].draw(pinA.sprite.x - LINE_START)\n    drawWhiskers()\n    //pinB.sprite.round()\n    //stripA.draw()\n    //stripB.draw()\n    //stripALabel.draw()\n    //stripBLabel.draw()\n  }\n  \n  // Called on resize\n  function resize(newFrame,flex){\n    // Make sure all layout parameters are up to date.\n    updateLayoutParams(newFrame)\n    app.renderer.resize(WINDOW_WIDTH,WINDOW_HEIGHT)\n    numberLine.draw()\n    topNumberLine.draw()\n    backGround.draw()\n    pinA.draw()\n    incButton.draw()\n    decButton.draw()\n    Rows.forEach(r=>r.draw())\n    drawWhiskers()\n  }\n\n  function updateLayoutParams(newFrame){\n    let frame;\n    if (newFrame){\n      frame = newFrame\n    } else {\n      frame = {width: WINDOW_WIDTH,height: WINDOW_HEIGHT}\n    }\n    WINDOW_WIDTH = frame.width\n    WINDOW_HEIGHT = frame.height\n    H_W_RATIO = frame.height/frame.width\n    LANDSCAPE = H_W_RATIO < 3/4\n    ARENA_WIDTH = LANDSCAPE ? 4/3*frame.height : frame.width\n    ARENA_HEIGHT = LANDSCAPE ? frame.height : 3/4*frame.width\n    LINE_WIDTH = LINE_PERCENTAGE*WINDOW_WIDTH\n    LINE_THICKNESS = LINE_WIDTH/200\n    TICK_THICKNESS = LINE_THICKNESS/2\n    MAJOR_TICK_HEIGHT = LINE_WIDTH/20\n    MINOR_TICK_HEIGHT = MAJOR_TICK_HEIGHT/2\n    DX = LINE_WIDTH/state.lineMax\n    LINE_START = WINDOW_WIDTH/2 - LINE_WIDTH/2\n    STRIP_HEIGHT = LINE_WIDTH/12\n  }\n\n  // Loading Script\n  function load(){\n    let features = {'strips': true}\n    if (setup.props.features){\n      features = setup.props.features\n    }\n\n\n    backGround = new makeBackground()\n\n    // Number Lines\n    numberLine = new makeNumberLine()\n    topNumberLine = new makeNumberLine(true)\n\n    pinA = new makePin(0)\n    pinA.sprite.y = BOTTOM_LINE_Y + 2*MINOR_TICK_HEIGHT\n    //pinB = new makePin(1)\n    incButton = makeArrowButton(5)\n    decButton = makeArrowButton(-5)\n    incButton.draw()\n    decButton.draw()\n    FirstRow = new Row(3,4,pinA.sprite.x - LINE_START,0)\n    SecondRow = new Row(1,3,pinA.sprite.x - LINE_START,1)\n    SecondRow.container.y = TOP_LINE_Y\n    Rows = [FirstRow,SecondRow]\n    app.stage.addChild(LeftWhisker)\n    app.stage.addChild(RightWhisker)\n    app.stage.addChild(PlusButton)\n    app.stage.addChild(MinusButton)\n    drawWhiskers()\n    placeButtons()\n  }\n\n  // Call load script\n  load()\n  // Not sure where else to put this.\n  app.resize = (frame) => resize(frame)\n  app.resizable = true\n};\n"]},"metadata":{},"sourceType":"module"}